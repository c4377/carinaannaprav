<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Blog Post | Carina Anna Prav</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        .post-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .post-header {
            margin-bottom: 40px;
        }
        .post-category {
            display: inline-block;
            background: #D4B896;
            color: #2D2D2D;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-bottom: 20px;
        }
        .post-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            line-height: 1.2;
        }
        .post-meta {
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 30px;
        }
        .post-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 40px;
        }
        .post-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #333;
        }
        .post-content h2 {
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        .post-content h3 {
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        .post-content p {
            margin-bottom: 20px;
        }
        .post-content ul, .post-content ol {
            margin-bottom: 20px;
            padding-left: 30px;
        }
        .post-content li {
            margin-bottom: 10px;
        }
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 30px 0;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 30px;
            color: #D4B896;
            text-decoration: none;
            font-weight: 600;
        }
        .share-buttons {
            margin-top: 60px;
            padding-top: 40px;
            border-top: 1px solid #e0e0e0;
        }
        .share-buttons h3 {
            margin-bottom: 20px;
        }
        .share-button {
            display: inline-block;
            margin-right: 15px;
            padding: 10px 20px;
            background: #D4B896;
            color: #2D2D2D;
            text-decoration: none;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 1.2rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="post-container">
        <a href="blog.html" class="back-link">‚Üê Zur√ºck zum Blog</a>
        
        <div id="post-content">
            <div class="loading">Lade Post...</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        async function loadPost() {
            const urlParams = new URLSearchParams(window.location.search);
            const postSlug = urlParams.get('post');
            
            if (!postSlug) {
                document.getElementById('post-content').innerHTML = 
                    '<div class="loading">Kein Post gefunden.</div>';
                return;
            }
            
            try {
                const response = await fetch(`https://raw.githubusercontent.com/c4377/carinaannaprav/main/content/blog/${postSlug}.md`);
                const content = await response.text();
                
                const parts = content.split('---');
                const frontmatter = parts[1];
                const body = parts.slice(2).join('---');
                
                const title = frontmatter.match(/title:\s*["']?(.+?)["']?\n/)?.[1] || 'Untitled';
                const date = frontmatter.match(/date:\s*(.+?)\n/)?.[1] || '';
                const category = frontmatter.match(/category:\s*["']?(.+?)["']?\n/)?.[1] || 'Allgemein';
                const image = frontmatter.match(/image:\s*["']?(.+?)["']?\n/)?.[1] || '';
                
                const formattedDate = new Date(date).toLocaleDateString('de-DE', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                const htmlContent = marked.parse(body.trim());
                
                document.getElementById('page-title').textContent = `${title} | Carina Anna Prav`;
                
                const postHTML = `
                    <article class="post-header">
                        <span class="post-category">${category}</span>
                        <h1 class="post-title">${title}</h1>
                        <div class="post-meta">${formattedDate}</div>
                        ${image ? `<img src="${image}" alt="${title}" class="post-image">` : ''}
                    </article>
                    
                    <div class="post-content">
                        ${htmlContent}
                    </div>
                    
                    <div class="share-buttons">
                        <h3>Teilen:</h3>
                        <a href="https://pinterest.com/pin/create/button/?url=${encodeURIComponent(window.location.href)}&description=${encodeURIComponent(title)}" 
                           target="_blank" class="share-button">üìå Pinterest</a>
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}" 
                           target="_blank" class="share-button">üíº LinkedIn</a>
                        <a href="mailto:?subject=${encodeURIComponent(title)}&body=${encodeURIComponent(window.location.href)}" 
                           class="share-button">‚úâÔ∏è Email</a>
                    </div>
                `;
                
                document.getElementById('post-content').innerHTML = postHTML;
                
            } catch (error) {
                console.error('Error loading post:', error);
                document.getElementById('post-content').innerHTML = 
                    '<div class="loading">Fehler beim Laden des Posts.</div>';
            }
        }
        
        loadPost();
    </script>

    <script>
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
    </script>
</body>
</html>